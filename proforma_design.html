<!DOCTYPE html>
<html lang="nl">
<head>
  <meta charset="UTF-8">
  <title>Proforma Loonberekening</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js"></script>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 30px auto;
      padding: 20px;
      max-width: 1000px;
      background-color: #f4f4f4;
      color: #002b6d;
    }

    h1 {
      color: #002b6d;
      border-bottom: 2px solid #0073e6;
      padding-bottom: 10px;
      margin-bottom: 20px;
    }

    form {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 20px 30px;
    }

    label {
      display: block;
      font-weight: bold;
      color: #002b6d;
    }

    input, select {
      width: 100%;
      padding: 8px 10px;
      margin-top: 4px;
      border: 1px solid #ccc;
      border-radius: 6px;
      font-size: 14px;
    }

    .fullwidth {
      grid-column: 1 / -1;
    }

    button {
      padding: 12px 24px;
      background-color: #002b6d;
      color: white;
      border: none;
      border-radius: 6px;
      font-size: 16px;
      cursor: pointer;
      margin-top: 10px;
    }

    button:hover {
      background-color: #0073e6;
    }

    .resultaat {
      margin-top: 32px;
      padding: 20px;
      background: white;
      border-left: 6px solid #05d6c8;
      box-shadow: 0 0 10px rgba(0,0,0,0.05);
      font-family: Consolas, monospace;
      font-size: 14px;
      line-height: 1.5;
      white-space: pre-wrap;
    }
  </style>
</head>
<body>
  <h1>Proforma Loonberekening</h1>

  <form>
    <label>Loon (€ per uur): <input type="number" id="loon" value="19.01"></label>
    <label>Aantal normale uren: <input type="number" id="urenNormaal" value="38"></label>

    <label>Overwerk1 (%): <input type="number" id="overwerk1"></label>
    <label>Overwerk1 uren: <input type="number" id="urenOverwerk1"></label>

    <label>Overwerk2 (%): <input type="number" id="overwerk2"></label>
    <label>Overwerk2 uren: <input type="number" id="urenOverwerk2"></label>

    <label>Kosten huisvesting (€): <input type="number" id="huisvesting" value="151"></label>
    <label>Land cola vergoeding:
      <select id="landCola">
        <option value="32">Roemenië</option>
        <option value="10">België</option>
        <option value="8">Hongarije</option>
        <option value="10">Polen</option>
      </select>
    </label>

    <label>Reiskosten ET (€): <input type="number" id="reiskostenET"></label>
    <label>Inhouden huur? <select id="invoerhuur"><option>ja</option><option>nee</option></select></label>

    <label>Inhouden zorgpremie? <select id="invoerzorg"><option>ja</option><option>nee</option></select></label>
    <label>Minimumloon (€ per uur): <input type="number" id="minimumLoon" value="14.06"></label>

    <label>ADV periodiek uitkeren? <select id="advUitkeren"><option>nee</option><option>ja</option></select></label>
    <label>ADV percentage (%): <input type="number" id="advPercentage"></label>

    <label>Bovenwettelijk verlof uitkeren? <select id="verlofUitkeren"><option>ja</option><option>nee</option></select></label>
    <label>Vakantiegeld uitkeren? <select id="vakantiegeldUitkeren"><option>ja</option><option>nee</option></select></label>

    <label>Kort verzuim uitkeren? <select id="kortVerzuimUitkeren"><option>nee</option><option>ja</option></select></label>
    <label>Loonheffingskorting toepassen? <select id="loonheffingskorting"><option>ja</option><option>nee</option></select></label>

    <div class="fullwidth">
      <button type="button" onclick="bereken()">Bereken</button>
    </div>
  </form>

  <div class="resultaat" id="resultaat">Bezig met laden van loonheffingstabel...</div>

  <script>
let loonheffingTabel = [];
Papa.parse("https://docs.google.com/spreadsheets/d/e/2PACX-1vQ6XrFlFD7qt0ZWCA1tG3Ogiq070YH1DxksJ0iGaRP82trSX-z3BTYp4uWFAnSX-wcITblotnaa54wc/pub?output=csv", {
  download: true,
  header: true,
  complete: function(results) {
    loonheffingTabel = results.data.map(row => {
      const keys = Object.keys(row);
      const brutoloonKey = keys.find(k => k.toLowerCase().includes("bruto"));
      const metKey = keys.find(k => k.toLowerCase().includes("loonheffings") && k.toLowerCase().includes("met"));
      const zonderKey = keys.find(k => k.toLowerCase().includes("loonheffings") && k.toLowerCase().includes("zonder"));
      
      return {
        bruto: parseFloat(row[brutoloonKey].replace(',', '.')),
        zonder: parseFloat(row[zonderKey].replace(',', '.')),
        met: parseFloat(row[metKey].replace(',', '.'))     
      };
    }).filter(r => !isNaN(r.bruto));

    document.getElementById("resultaat").innerText = "Klaar voor berekening.";
  }
});
</script>

  
  <!-- Script blijft ongewijzigd -->
</body>
</html>
